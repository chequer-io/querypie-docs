---
title: 'Maintenance'
---

import { Callout } from 'nextra/components'

# Maintenance

### Overview

QueryPie의 버전 업그레이드 작업을 할 경우 QueryPie가 기록하는 Log DB는 대용량이라 백업이 어렵고 주요 기능들이 업그레이드 중에도 기록을 멈추지 않도록 하려면 적절한 서비스 제공 수준의 제어가 필요합니다.
이에 유지보수 모드를 설정하고 마이그레이션 작업을 수행합니다.

참고로, QueryPie 서버가 2대의 서버로 이중화 되어 있는 경우의 업그레이드 절차는 아래와 같습니다.

1.  **준비** : 최신 패키지 다운로드 및 설정 파일을 확인합니다.
2.  **유지보수 모드 설정** : 작업 공지 후, 시스템의 서비스 접근 수준을 제한합니다.
3.  **데이터베이스 준비** : 신규 버전용 스키마를 생성하고 기존 데이터를 복제합니다.
4.  **2번 서버 업그레이드** : LB에서 2번 서버를 분리하고, 마이그레이션 및 2번 서버에 신규 버전을 설치합니다.
5.  **2번 서버 테스트** : 2번 서버로 직접 접속하여 업그레이드 결과를 확인합니다.
6.  **1번 서버 업그레이드** : LB에 2번 서버를 다시 연결하고 1번 서버를 분리한 뒤, 1번 서버에 신규 버전을 설치합니다.
7.  **최종 전환** : LB에 1번 서버를 다시 연결하여 전체 서비스 업그레이드를 종료합니다.

<Callout type="info">
유지보수 모드 설정 기능은 11.3.0에 추가되었습니다.
</Callout>

### 유지보수 모드(Operation Mode) 설정

<Callout type="important">
서비스 전체에 대한 영향을 주기 때문에 신중하게 결정하고 작업을 진행해야 합니다.
</Callout>

<figure data-layout="center" data-align="center">
![Admin &gt; General &gt; System &gt; Maintenance](/administrator-manual/general/system/maintenance/image-20250928-205515.png)
<figcaption>
Admin &gt; General &gt; System &gt; Maintenance
</figcaption>
</figure>

설정할 수 있는 Mode는 아래와 같습니다.

|  **Mode**        |  **설명**                                                                                                                                                                                                                 |
| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Read Only        | 사용자가 Login이 가능하지만 조회를 제외한 다른 기능은 사용할 수 없습니다. Read-Only를 적용한 즉시 새로운 명령은 수행되지 않습니다. 이미 수행된 쿼리 및 명령은 정상 수행 및 종료 됩니다. (SAC의 경우Read Only 상태로 전환된 뒤 최초 명령 수행은 수행되고 Audit Log에 기록되지만 두번째 명령 부터는 수행되지 않고 Audit Log도 기록되지 않습니다.) |
| Active Session   | 이미 존재하는 세션에서는 명령어 수행이 가능하지만 새로운 세션은 조회를 제외한 명령어 수행을 할 수 없습니다. (WAC에 적용 불가)                                                                                                                                              |
| Allow Connection | 이미 존재하는 세션과 새로운 세션에서 명령어 수행이 가능하지만 Workflow 상신이나 설정 수정등의 작업은 허용되지 않습니다. (WAC에 적용 불가)                                                                                                                                    |
| Full Access      | 일반적인 평상시의 동작 모드입니다.                                                                                                                                                                                                     |
