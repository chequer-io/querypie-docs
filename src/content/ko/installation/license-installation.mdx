---
title: '라이선스 설치'
---

import { Callout } from 'nextra/components'

# 라이선스 설치

QueryPie 제품의 License 를 최초 설치, 업그레이드 설치하는 방법을 안내합니다.

### QueryPie 를 처음 설치하는 경우<Badge color="grey">11.3.0</Badge>

QueryPie ACP 를 처음 설치하여 실행하는 경우, 웹브라우저로 웹콘솔에 접속하게 되면, 라이선스 입력을 요구합니다.
라이선스를 정상적으로 입력하게 되면, 로그인 화면을 만나게 됩니다.

<figure data-layout="center" data-align="center">
<img src="/installation/license-installation/image-20260130-054810.png" alt="PEM 형식 라이선스 입력 화면" width="760" />
<figcaption>
PEM 형식 라이선스 입력 화면
</figcaption>
</figure>

### 라이선스를 추가, 교체하기<Badge color="grey">11.3.0</Badge>

11.3.0 또는 이후 버전에서는 웹콘솔에서 제품의 License 를 설치, 추가, 교체할 수 있습니다: [Licenses](../administrator-manual/general/company-management/licenses)

#### 다수의 라이선스 설치 후 관리하기

11.3.0 이전 버전에는 License 의 유효기간이 겹치는 라이선스를 추가 설치할 수 없는 제약이 있었으나, 11.3.0 부터는 유효기간이 겹치는 라이선스를 추가 설치할 수 있습니다.
유효한 라이선스가 둘 이상인 경우, 유효한 라이선스를 관리자가 지정할 수 있습니다.

유효한 라이선스의 상태는 활성화 여부에 따라, 다음과 같이 구분됩니다.

* Activated : 현재 활성화된 상태
* Available : 사용 가능한 license이지만 활성화 하지 않은 상태

### QueryPie 를 처음 설치하는 경우<Badge color="grey">Deprecated</Badge>

QueryPie 를 처음 설치하는 경우, QueryPie Tools 라는 컴포넌트를 실행하여, Product License 를 설치할 수 있습니다.
QueryPie Tools 는 QueryPie Server 와 별개로 작동하는 도구로, 제품 설치, 업그레이드, 라이선스 설치 등에 사용하는 도구입니다.

QueryPie Tools 를 이용해 Product License 설치하는 방법을 간단히 설명하면 다음과 같습니다.

`docker-compose` 명령으로 QueryPie Tools Container 를 실행합니다.
```
ubuntu@querypie:~/querypie/10.2.4$ docker-compose --env-file compose-env --profile tools up -d
[+] Running 1/1
 ⠿ Container querypie-tools-1  Started                                                                                                             0.2s
ubuntu@querypie:~/querypie/10.2.4$ 
```

`curl` 명령으로 `license.crt` 라는 라이선스 파일을 QueryPie Tools 의 API 를 통해 설치합니다. `license.crt` 라이선스 파일 이름은 예시이며, 기술지원 담당자로부터 전달 받은 제품의 라이선스 파일을 서버에 옮겨 저장한 것입니다.
다른 파일이름을 사용하여도 무방합니다.
```
ubuntu@querypie:~/querypie/10.2.4$ curl -XPOST 127.0.0.1:8050/license/upload -F file=@license.crt
[License] Upload: Success
ubuntu@querypie:~/querypie/10.2.4$ 
```

`[License] Upload: Success` 라는 응답 메시지를 만난 경우, 정상적으로 라이선스가 설치된 것입니다.

전반적인 제품 설치 과정과 Product License 설치 단계에 대한 상세한 설명은 다음 문서를 참조하여 주세요: [설치 가이드 - 간단한 구성](installation/installation-guide-simple-configuration)

### 사용 중인 QueryPie 의 라이선스를 연장하는 경우<Badge color="grey">Deprecated</Badge>

현재 사용 중인 QueryPie 에 라이선스를 연장하고자 하는 경우가 있습니다.
예를 들어, PoC 진행 중이던 QueryPie Server Instance 에 Production License 를 설치하여, 기존 PoC License 를 연장하고자 하는 경우를 가정합니다.

새로운 Production 라이선스의 유효기간이, 기존 PoC 라이선스의 유효기간과 겹치는 기간이 없는 경우, 새로운 Production 라이선스를 간단히 추가하여 설치할 수 있습니다.
절차는 다음과 같습니다.

`docker-compose` 명령으로 QueryPie Tools Container 를 실행합니다.

`docker-compose --env-file compose-env --profile tools up -d`
```
ubuntu@querypie:~/querypie/10.2.4$ docker-compose --env-file compose-env --profile tools up -d
[+] Running 1/1
 ⠿ Container querypie-tools-1  Started 0.2s
ubuntu@querypie:~/querypie/10.2.4$ 
```

`curl` 명령으로 `license.crt` 라는 라이선스 파일을 QueryPie Tools 의 API 를 통해 설치합니다. `license.crt` 라이선스 파일 이름은 예시이며, 기술지원 담당자로부터 전달 받은 제품의 라이선스 파일을 서버에 옮겨 저장한 것입니다.
다른 파일이름을 사용하여도 무방합니다.

`curl -XPOST 127.0.0.1:8050/license/upload -F file=@license.crt`
```
ubuntu@querypie:~/querypie/10.2.4$ curl -XPOST 127.0.0.1:8050/license/upload -F file=@license.crt
[License] Upload: Success
ubuntu@querypie:~/querypie/10.2.4$ 
```

`[License] Upload: Success` 라는 응답 메시지를 만난 경우, 정상적으로 라이선스가 설치된 것입니다.

세부 과정을 살펴보면, 처음 설치 시점의 라이선스 설치 과정과 동일합니다.

그러나, 경우에 따라, `[License] Upload: The periods overlap.` 라는 응답 메시지를 만날 수 있으며, 이 경우, 새로운 라이선스 설치에 실패한 것입니다.
이 응답 메시지를 만난 경우 대처 방법은, “사용 중인 QueryPie 의 라이선스를 교체하는 경우” 섹션을 참고하시기 바랍니다.


### 사용 중인 QueryPie 의 라이선스를 교체하는 경우<Badge color="grey">Deprecated</Badge>

QueryPie 의 License 관리 기능에는 한가지 제약사항이 있어서, 기존 라이선스의 유효기간과 새 라이선스의 유효기간이 일부 겹치는 경우, 새 라이선스를 추가로 설치하지 못합니다.
이로 인해, 유효기간이 겹치는 라이선스를 설치하려는 경우, 별도 절차를 통하여 기존 라이선스를 삭제한 후, 새로운 라이선스를 설치하여야 합니다.

<Callout type="important">
11.3.0 또는 이후 버전에는 이 제약이 해소되었습니다.
참조: [Licenses](../administrator-manual/general/company-management/licenses)
</Callout>

기존 라이선스를 삭제하는 방법은 크게 두 가지가 있습니다.

* Docker Container 내부에서 mysql client 을 사용하여, 기존 라이선스를 삭제하기
* QueryPie Web Console 에서 QueryPie MySQL 에 연결하여, 기존 라이선스를 삭제하기
    * QueryPie DAC 기능을 이용하는 고객의 경우, DAC 의 Database Connection 을 추가하여, QueryPie MySQL Database 에 연결할 수 있습니다. 자세한 방법은 이 문서에서 설명하지 않습니다.

이 문서에서는 Docker Container 내부에서 mysql client 을 사용하여, 기존 라이선스를 삭제하는 방법을 설명합니다.

#### 기존 라이선스 삭제하기

QueryPie Server Container 가 작동 중인 리눅스 서버에 터미널로 연결합니다.

docker exec 명령을 실행하여, QueryPie Server Container 내부의 bash 를 실행합니다.

`docker exec -it querypie-app-1 bash`
```
ubuntu@querypie:~/querypie/10.2.4$ docker exec -it querypie-app-1 bash
022f073afae5:/app# 
```

Container 내부에서 mysql client 을 실행하여, QueryPie MySQL 에 연결합니다.
Container 내부에서는 환경변수가 정의되어 있어서, QueryPie MySQL 에 연결하기 위한 정보가 제공됩니다.
아래의 `mysql` 명령에서 `-h`, `$DB_HOST` 등 옵션이름과 옵션값 사이에 공백이 없다는 것에 주의하여 주세요.

`mysql -h$DB_HOST -u$DB_USERNAME -p$DB_PASSWORD $DB_CATALOG`
```
ubuntu@querypie:~/querypie/10.2.4$ docker exec -it querypie-app-1 bash
022f073afae5:/app# mysql -h$DB_HOST -u$DB_USERNAME -p$DB_PASSWORD $DB_CATALOG
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 257
Server version: 8.0.30 MySQL Community Server - GPL

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [querypie]> 
```

다음의 SQL 을 실행하여, 설치된 라이선스 파일의 수를 확인해 봅니다.
이 값이 0 인 경우, 아직 라이선스가 설치되지 않은 것입니다.

`SELECT COUNT(*) FROM certificates;`
```
MySQL [querypie]> SELECT COUNT(*) FROM certificates;
+----------+
| count(*) |
+----------+
|        1 |
+----------+
1 row in set (0.001 sec)

MySQL [querypie]> 
```

다음의 SQL 을 실행하면, 설치된 라이선스 파일을 삭제하게 됩니다.

`DELETE FROM certificates;`
```
MySQL [querypie]> DELETE FROM certificates;
Query OK, 1 row affected (0.007 sec)

MySQL [querypie]> 
```

이후 exit 명령을 입력하여, Container 내부에서 빠져 나옵니다.
```
MySQL [querypie]> exit
Bye
022f073afae5:/app# exit
exit
ubuntu@querypie:~/querypie/10.2.4$ 
```


#### QueryPie Tools 를 실행하여, License 를 설치하기

이제 QueryPie Tools 를 실행하여, License 를 설치합니다.
처음 설치 때와 마찬가지 방식으로, 라이선스를 설치할 수 있습니다.

`docker-compose` 명령으로 QueryPie Tools Container 를 실행합니다.

`docker-compose --env-file compose-env --profile tools up -d`
```
ubuntu@querypie:~/querypie/10.2.4$ docker-compose --env-file compose-env --profile tools up -d
[+] Running 1/1
 ⠿ Container querypie-tools-1  Started  0.2s
ubuntu@querypie:~/querypie/10.2.4$ 
```

`curl` 명령으로 `license.crt` 라는 라이선스 파일을 QueryPie Tools 의 API 를 통해 설치합니다. `license.crt` 라이선스 파일 이름은 예시이며, 기술지원 담당자로부터 전달 받은 제품의 라이선스 파일을 서버에 옮겨 저장한 것입니다.
다른 파일이름을 사용하여도 무방합니다.

`curl -XPOST 127.0.0.1:8050/license/upload -F file=@license.crt`
```
ubuntu@querypie:~/querypie/10.2.4$ curl -XPOST 127.0.0.1:8050/license/upload -F file=@license.crt
[License] Upload: Success
ubuntu@querypie:~/querypie/10.2.4$ 
```

`[License] Upload: Success` 라는 응답 메시지를 만난 경우, 정상적으로 라이선스가 설치된 것입니다.

#### QueryPie Server Container 를 재시작하기

이제, QueryPie Server Container 를 재시작하여 주세요.

* `docker-compose --env-file compose-env --profile querypie down`
* `docker-compose --env-file compose-env --profile querypie up -d`

설치된 QueryPie Web Console 에서, 제품이 정상적으로 작동하는지 확인하여 주세요.

지금까지, 기존 라이선스를 교체하여, 새로운 라이선스를 설치하는 과정을 살펴보았습니다.
수고하셨습니다.


