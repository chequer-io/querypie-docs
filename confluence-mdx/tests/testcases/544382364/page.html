<div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-id="a03a3802-d35d-4956-8454-ab544398e5ba" data-macro-name="info"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>해당 문서는 <strong>QueryPie Enterprise 9.20.0 기준</strong>으로 작성되었습니다.</p></div></div><div class="toc-macro client-side-toc-macro  conf-macro output-block" data-cssliststyle="disc" data-excludeheaderregex="토픽" data-hasbody="false" data-headerelements="H1,H2,H3,H4,H5,H6" data-layout="default" data-local-id="7044a520-d23f-4ce1-9d21-1ec2df329420" data-macro-id="908303f4-956c-42f6-934c-e029e57519ad" data-macro-name="toc" data-numberedoutline="false" data-structure="list"> </div><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-쿼리파이접근제어정책개요">쿼리파이 접근 제어 정책 개요  </h2><p>쿼리파이에서 정의하는 접근 제어 정책은 EABAC(Enhanced Attribute Based Access Control)을 기반으로 동작합니다. EABAC은 쿼리파이 사용자의 역할(Role)과 속성(Attribute)을 기반으로 쿼리파이에 등록된 리소스에 대한 접근을 제어하고 권한 관리를 수행할 수 있는 정책의 통제 방식을 의미합니다. RBAC(Role-Based Access Control) 및 ABAC(Attribute-Based Access Control)의 기능을 결합하여 더욱 유연하고 정교한 접근 제어를 제공합니다. 모든 정책은 All Deny를 전제로 동작합니다. </p><p>EABAC 은 Role, Policy 두 가지로 동작합니다. Role 설정은 GUI 로 하며, Policy 정의는 코드(YAML)로 관리합니다.</p><p>쿠버네티스 정책의 경우, 실제 쿠버네티스에 존재하는 네임스페이스에 국한되는 Role과 네임스페이스 범위 외 리소스를 지원하는 ClusterRole 양측 모두를 수용할 수 있는 종합적 모델로 스펙이 제작되었습니다. </p><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-쿠버네티스정책YAML기본구조">쿠버네티스 정책 YAML 기본 구조</h2><p>일부 항목을 제외한 전반 정책 코드에서 와일드카드(“*”) 및 정규표현식(<a class="external-link" href="https://github.com/girishji/re2/wiki/Syntax">RE2 형식</a>: <code>^$</code> 명시 필수) 패턴을 지원합니다.</p><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="35831a4b-16f9-461f-96a1-0af983cbf59e" class="confluenceTable"><colgroup><col style="width: 111.0px;"/><col style="width: 110.0px;"/><col style="width: 87.0px;"/><col style="width: 255.0px;"/><col style="width: 197.0px;"/></colgroup><tbody><tr><th data-highlight-colour="var(--ds-background-accent-gray-subtlest, #F4F5F7)" class="confluenceTh"><p><strong>Category</strong></p></th><th data-highlight-colour="var(--ds-background-accent-gray-subtlest, #F4F5F7)" class="confluenceTh"><p><strong>Property</strong></p></th><th data-highlight-colour="var(--ds-background-accent-gray-subtlest, #F4F5F7)" class="confluenceTh"><p><strong>Required</strong></p></th><th data-highlight-colour="var(--ds-background-accent-gray-subtlest, #F4F5F7)" class="confluenceTh"><p><strong>Description</strong></p></th><th data-highlight-colour="var(--ds-background-accent-gray-subtlest, #F4F5F7)" class="confluenceTh"><p><strong>Valid Values</strong></p></th></tr><tr><td class="confluenceTd"><p><code>apiVersion</code></p></td><td class="confluenceTd"><p>-</p></td><td class="confluenceTd"><p>O</p></td><td class="confluenceTd"><p>작성된 YAML Code의 버전입니다. 시스템에서 관리하는 값으로, 수정이 불필요합니다.</p></td><td class="confluenceTd"><p><code>kubernetes.rbac.querypie.com/v1</code></p></td></tr><tr><td class="confluenceTd"><p><code>kind</code></p></td><td class="confluenceTd"><p>-</p></td><td class="confluenceTd"><p>O</p></td><td class="confluenceTd"><p>작성된 YAML Code의 종류입니다. 시스템에서 관리하는 값으로, 수정이 불필요합니다.</p></td><td class="confluenceTd"><p><code>KacPolicy</code></p></td></tr><tr><td class="confluenceTd"><p><code>spec:</code><br/>  <code>&lt;effect&gt;</code></p></td><td class="confluenceTd"><p>-</p></td><td class="confluenceTd"><p>O</p></td><td class="confluenceTd"><p>정책의 구체적인 규칙의 허용 또는 거부 여부 지정합니다. </p><ul><li><p>각 정책은 이하의 스펙만 허용합니다: </p><ul><li><p>단일 Allow </p></li><li><p>단일 Deny</p></li><li><p>단일 Allow &amp; 단일 Deny</p></li></ul></li><li><p>Deny가 Allow보다 우선순위가 높습니다.</p></li></ul></td><td class="confluenceTd"><p><code>allow</code>, <code>deny</code></p></td></tr><tr><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p><code>resources</code></p></td><td class="confluenceTd"><p>O</p></td><td class="confluenceTd"><p>접근을 허용/거부할 리소스를 지정합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-complete conf-macro output-inline" data-hasbody="false" data-macro-id="2cc8eb02-be82-493c-9696-cb2a8aaf9c0d" data-macro-name="status">와일드카드 및 정규표현식 허용</span> </p></td><td class="confluenceTd"><p><code>- &quot;cluster:*&quot;</code></p><p><code>- &quot;cluster:^eks-.*$&quot;</code></p></td></tr><tr><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p><code>subjects</code></p></td><td class="confluenceTd"><p>O</p></td><td class="confluenceTd"><p>쿠버네티스 명령을 impersonate할 쿠버네티스 사용자/그룹을 지정합니다.</p><ul><li><p><code>kubernetesGroups</code> : 쿼리파이 Proxy가 이용할 kubernetes group을 지정합니다.</p></li><li><p><code>impersonation</code> : 클라이언트 단에서 impersonation을 허용할 대상 사용자/그룹을 지정합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-success conf-macro output-inline" data-hasbody="false" data-macro-id="fa4575b4-d73e-4bda-9c0c-7bcadd159131" data-macro-name="status">와일드카드 허용</span></p></li></ul></td><td class="confluenceTd"><p><code>kubernetesGroups:</code><br/>    <code>- &quot;system:masters&quot;</code><br/>    <code>- $user.groups</code></p><p><code>impersonation:</code><br/><code>  users:</code><br/><code>    - &quot;system:user&quot;</code><br/><code>  groups:</code><br/><code>    - &quot;system:admin&quot;</code></p></td></tr><tr><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p><code>actions</code></p></td><td class="confluenceTd"><p>O</p></td><td class="confluenceTd"><p>쿠버네티스 클러스터 API 서버 내 허용/거부할 Resource API를 명시합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-complete conf-macro output-inline" data-hasbody="false" data-macro-id="e912d28f-47c8-430a-8eb3-451106ee642d" data-macro-name="status">와일드카드 및 정규표현식 허용</span></p><ul><li><p><code>apiGroups</code> : 쿠버네티스 API 그룹 리스트를 정의합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-success conf-macro output-inline" data-hasbody="false" data-macro-id="3a892c80-dd2d-4d0d-86e8-40d71489ca7c" data-macro-name="status">와일드카드 허용</span></p></li><li><p><code>resources</code> : 쿠버네티스 리소스를 정의합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-success conf-macro output-inline" data-hasbody="false" data-macro-id="9d067dba-4481-407e-b2a0-0d2974eb3e4b" data-macro-name="status">와일드카드 허용</span></p></li><li><p><code>namespace</code> : 대상 네임스페이스를 정의합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-complete conf-macro output-inline" data-hasbody="false" data-macro-id="ee658e14-29a8-455b-a0ea-d7ac57a33b1f" data-macro-name="status">와일드카드 및 정규표현식 허용</span></p></li><li><p><code>name</code> : 대상 리소스명을 정의합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-complete conf-macro output-inline" data-hasbody="false" data-macro-id="15a65f3b-eb3d-4190-831e-5540f6188524" data-macro-name="status">와일드카드 및 정규표현식 허용</span></p></li><li><p><code>verbs</code> : 작업을 허용하거나 거부할 kubernetes 내의 권한을 명시합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-success conf-macro output-inline" data-hasbody="false" data-macro-id="9cfda9ca-fc7f-4de2-8ec0-c101880b7527" data-macro-name="status">와일드카드 허용</span></p></li></ul></td><td class="confluenceTd"><p><code>- apiGroups: [&quot;*&quot;]</code><br/><code>  resources:</code><br/><code>    - &quot;*&quot;</code><br/><code>  namespace: &quot;*&quot;</code><br/><code>  name: &quot;*&quot;</code><br/><code>  verbs: [&quot;*&quot;]</code></p></td></tr><tr><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p><code>conditions</code></p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p>리소스 접근 정책 적용 여부를 조건으로 적용 대상을 세부 제어합니다.</p><ul><li><p><code>resourceTags</code> : 리소스 태그의 키와 값으로 필터링할 수 있습니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-progress conf-macro output-inline" data-hasbody="false" data-macro-id="cdd97253-608a-45c6-97f3-2030124d3737" data-macro-name="status">VALUE 와일드카드 및 정규표현식 허용</span> </p></li><li><p><code>userAttributes</code> : 사용자의 attribute을 조건으로 권한 사용을 제한합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-progress conf-macro output-inline" data-hasbody="false" data-macro-id="95292a1e-204c-4424-ba9c-5d18a066b680" data-macro-name="status">VALUE 와일드카드 및 정규표현식 허용</span></p></li><li><p><code>ipAddresses</code> : 리소스에 대한 IP 접근 통제 조건 리스트를 단일IP, CIDR 형태으로 정의합니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-success conf-macro output-inline" data-hasbody="false" data-macro-id="e9384081-7c4a-47ac-b325-981b4c04f5cb" data-macro-name="status">와일드카드 허용</span></p></li></ul></td><td class="confluenceTd"><p><code>resourceTags:      </code><br/><code>  - &quot;Owner&quot;: &quot;Daniel&quot;</code><br/><code>userAttributes:    </code><br/><code>  - &quot;department&quot;: &quot;DevOps&quot;   ipAddresses: </code><br/><code>  - &quot;10.10.10.0/24&quot;</code></p></td></tr></tbody></table></div><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-Resources명시방법">Resources 명시 방법</h2><p><code>resources</code>는 <u>쿠버네티스의 리소스가 아닌</u> 쿼리파이에 등록된 쿠버네티스 클러스터에 대한 리소스를 정의합니다.</p><ol start="1"><li><p>해당 <code>resources</code> 필드에 대한 정의는 필수입니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-error conf-macro output-inline" data-hasbody="false" data-macro-id="b54b33dd-77c5-47b4-9c5c-1e103ead3ed1" data-macro-name="status">REQUIRED</span> </p></li><li><p>쿠버네티스 클러스터명을 바탕으로 입력합니다.</p><ul><li><p><code>&quot;cluster:{Kubernetes Cluster Name in QueryPie}&quot;</code></p></li></ul></li><li><p>쿠버네티스 클러스터명은 이하의 기준으로 정립됩니다. </p><ul><li><p>문자 길이 100자 제한</p></li><li><p>알파벳 대소문자 (case-sensitive), 숫자 및 이하 특수기호만 허용</p><ul><li><p>underscore (_)</p></li><li><p>hyphen (-)</p></li></ul></li><li><p>이름 시작과 끝은 알파벳 대소문자 또는 숫자로 제한</p></li><li><p>클러스터명은 중복을 제한</p></li></ul></li><li><p>쿠버네티스 클러스터는 단일 정책에서 다중으로 지정이 가능합니다. </p><ul><li><p><code>- &quot;cluster:kubepie-dev-1&quot;</code><br/><code>- &quot;cluster:kubepie-dev-2&quot;</code></p></li><li><p><code>[&quot;cluster:kubepie-dev-1&quot;, &quot;cluster:kubepie-dev-2&quot;]</code></p></li></ul></li><li><p>경로는 와일드카드를 허용합니다.</p><ul><li><p><code>&quot;cluster:kubepie-dev-*&quot;</code></p></li></ul></li><li><p>경로는 정규표현식을 허용합니다.</p><ul><li><p><code>&quot;cluster:^kubepie-dev-.*$&quot;</code></p></li></ul></li></ol><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-Subjects명시방법">Subjects 명시 방법</h2><p><code>subjects</code>는 쿠버네티스 명령을 impersonate할 쿠버네티스 내 사용자/그룹을 정의합니다. <code>subjects</code>는 spec:allow에 한해 적용이 필요한 필드로, spec:deny에서는 문법적으로 허용되지 않습니다. </p><ol start="1"><li><p><code>kubernetesGroups</code>: <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-error conf-macro output-inline" data-hasbody="false" data-macro-id="4bb074c1-fb2a-4db5-a5dd-02e5c33463aa" data-macro-name="status">REQUIRED</span></p><ul><li><p>리소스에 대한 API 수행을 위해 쿼리파이 Proxy가 impersonate할 kubernetes 그룹 계정을 정의합니다.</p><ul><li><p>해당 subjects는 Policy-wide 레벨에서 정의할 수 있어야 하며, 최소 하나가 배정되도록 정의되어야 합니다.</p><ul><li><p>Impersonation을 위한 해당 subjects는 다른 Policy들과 하나의 Role 내에서 중첩이 가능합니다.</p></li></ul></li><li><p>Resources에 명시된 리소스에 대한 권한 수행이 가능한 kubernetes 측 그룹(단일 또는 복수)을 정의합니다.</p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="01f0f4a3-7e24-4ea8-9e5b-817a3c4ad756" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">kubernetesGroups: 
  - system:masters
  - default-group-account</pre>
</div></div></li><li><p>kubernetesGroups에는 Querypie User의 Group을 예약어 형태로 입력할 수 있습니다. 이 때, User의 Group은 쌍따옴표(“) 없이 입력 입력되어야 하며, 사용자가 Policy를 볼 땐 실제 user Group의 값이 표시됩니다.</p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="dad5f979-5d57-4803-9000-64e1be392bd5" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">kubernetesGroups: 
  - $user.groups</pre>
</div></div></li></ul></li></ul></li><li><p><code>impersonation</code>: <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-current conf-macro output-inline" data-hasbody="false" data-macro-id="65bc7992-ce51-469e-971f-a2d21fcb204c" data-macro-name="status">OPTIONAL</span></p><ul><li><p>사용자가 클라이언트 단에서 kubernetes 내 특정 serviceaccount 등의 권한으로 kubectl 명령에 impersonation(--as, --as-group)을 시도하는 경우, 이에 대한 호출 허용 목록을 정의합니다.</p><ul><li><p><code>users</code>: 쿠버네티스 내 존재하는 사용자/서비스 계정으로 &quot;--as&quot; 파라미터에 허용 가능한 값을 나열합니다.</p></li><li><p><code>groups</code>: 쿠버네티스 내 존재하는 그룹 계정으로 &quot;--as-group&quot; 파라미터에 허용 가능한 값을 나열합니다.</p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="68ebe426-b925-4db3-9c85-e214f6c05a1b" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">impersonation: 
  users: 
    - &quot;system:serviceaccount:argocd&quot;
  groups: 
    - &quot;system:admin&quot;</pre>
</div></div></li><li><p>와일드카드를 허용합니다. (<code>&quot;*&quot;</code>)</p></li></ul></li></ul></li></ol><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-Actions명시방법">Actions 명시 방법</h2><p>클러스터 API 서버 내 허용할 Resource API 리스트를 명시합니다. 각 action에는 <code>apiGroups</code>, <code>resources</code>, <code>namespace</code>, <code>name</code>, <code>verbs</code> 기입이 필요합니다. </p><ol start="1"><li><p><code>apiGroups</code> : 쿠버네티스 API 그룹 리스트를 정의합니다. </p><ol start="1"><li><p>API 그룹을 정의함으로써 더욱 세부적인 권한 통제가 API 그룹별로 가능합니다. </p></li><li><p>커스텀 리소스에 대한 통제가 필요 시, apiGroups에 명시하여 커스텀 리소스에 한하여 통제도 가능합니다. </p></li><li><p>참고: </p><ol start="1"><li><p><a class="external-link" href="https://kubernetes.io/docs/reference/using-api/#api-groups">API Groups 안내 </a></p></li><li><p><a class="external-link" href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.30/#api-groups">API Group 목록</a> </p></li></ol></li><li><p>와일드카드를 허용하여 API 그룹 전체를 포괄적으로 지정하는 것이 가능합니다.</p><ul><li><p><code>apiGroups: [&quot;*&quot;]</code></p></li></ul></li></ol></li><li><p><code>resources</code> : 쿠버네티스 리소스 리스트를 정의합니다.</p><ol start="1"><li><p>일반적으로 많이 쓰이는 리소스는 이하와 같습니다:</p><ul><li><p><code>pods</code>, <code>pods/exec</code>, <code>pods/log</code>, <code>pods/portforward</code>, <code>services</code>, <code>ingresses</code>, <code>deployments</code>, <code>replicasets</code>, <code>statefulsets</code>, <code>daemonsets</code>, <code>configmaps</code>, <code>secrets</code>, <code>namespaces</code>, <code>nodes</code>, <code>persistentvolumes</code>, <code>persistentvolumeclaims</code>, <code>jobs</code>, <code>cronjobs</code>, <code>serviceaccounts</code>, <code>endpoints</code>, <code>roles</code>, <code>rolebindings</code>, <code>clusterroles</code>, <code>clusterrolebindings</code></p></li></ul></li><li><p>위에 표기되지 않은 리소스 또한 정책에서 수용이 가능합니다. </p></li><li><p>네임스페이스 하위 리소스만 지정하여 권한을 부여하더라도, Namespace에 대한 ReadOnly 권한이 함께 부여됩니다. 따라서, 리소스 호출 시 매번 네임스페이스 명시해주어야 하는 사례가 발생되지 않습니다. 특정 네임스페이스에 대한 권한 부여를 방지하고자 하는 경우, <code>spec:deny</code> 에서 네임스페이스 리소스에 대한 접근 거부를 설정할 수 있습니다. </p></li><li><p>단일 정책 액션에서 다중으로 리소스 지정이 가능합니다. </p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="598f0299-fb6f-4fcb-bcef-888f8b3d7865" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"> resources:
   - &quot;pods&quot;
   - &quot;deployments&quot;
   - &quot;configmaps&quot;</pre>
</div></div></li><li><p>와일드카드를 허용합니다. (<code>&quot;*&quot;</code>)</p></li></ol></li><li><p><code>namespace</code> : 대상 네임스페이스를 정의합니다. </p><ol start="1"><li><p>네임스페이스를 액션에서 정의하여 클러스터 내 허용 대상 네임스페이스를 리소스별로 제어할 수 있습니다. </p></li><li><p>와일드카드와 정규표현식 모두 허용합니다.</p><ul><li><p><code>namespace: &quot;*&quot;</code></p></li></ul></li><li><p>namespaces 외 네임스페이스에 존속되지 않는 리소스의 경우, 해당 namespace를 작성하지 않아도 됩니다.</p><ol start="1"><li><p>대상 예) <code>persistentvolumes</code>, <code>persistentvolumeclaims</code>, <code>serviceaccounts</code>, <code>customresourcedefinitions</code>, <code>endpoints</code>, <code>nodes</code>, <code>clusterroles</code>, <code>clusterrolebindings</code> 등</p></li></ol></li></ol></li><li><p><code>name</code> : 대상 리소스명을 정의하여 클러스터 내 허용 리소스 중 네이밍을 바탕으로 제어가 가능합니다. </p><ol start="1"><li><p>와일드카드와 정규표현식 모두 허용합니다.</p><ul><li><p><code>name: &quot;pods-*&quot;</code></p></li></ul></li></ol></li><li><p><code>verbs</code> : 작업을 허용하거나 거부할 kubernetes 내의 API 권한을 명시합니다.</p><ul><li><p>일반적으로 호출되는 verb는 아래와 같습니다: </p><ul><li><p><code>get</code>: 리소스 정보 검색</p></li><li><p><code>list</code>: 리소스 목록 나열</p></li><li><p><code>watch</code>: 리소스 변경사항 주시 </p></li><li><p><code>create</code>: 새로운 리소스 생성</p></li><li><p><code>update</code>: 기존 리소스 업데이트</p></li><li><p><code>patch</code>: 리소스 부분 수정</p></li><li><p><code>delete</code>: 리소스 삭제 </p></li><li><p><code>deletecollection</code>: 단일 작업에서 여러 자원 삭제</p></li></ul></li><li><p>위에 표기되지 않은 특수한 verb가 있더라도 정책에 명시하여 적용 가능합니다. </p></li><li><p>3rd-Party 클라이언트 지원 시 이하의 verb가 필수로 요구되며 안내합니다: </p><ul><li><p>View 권한 : <code>get</code>, <code>list</code>, <code>watch</code></p></li><li><p>Edit 권한 : <code>get</code>, <code>list</code>, <code>watch</code> + <code>create</code>, <code>update</code>, <code>patch</code>, <code>delete</code>, <code>deletecollection</code></p></li></ul></li><li><p>pod exec명령을 통한 컨테이너 쉘 접속 세션 생성을 위해서는 일반적으로 <code>create</code> verb 명시가 필요합니다. </p></li><li><p>와일드카드를 허용합니다. </p><ul><li><p><code>verbs: [&quot;*&quot;]</code></p></li></ul></li></ul></li></ol><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-Conditions명시방법">Conditions 명시 방법</h2><p><code>conditions</code> 항목에는 <code>resourceTags</code>, <code>userAttributes</code>, <code>ipAddresses</code>를 조건으로 정의할 수 있습니다. <span class="status-macro aui-lozenge aui-lozenge-visual-refresh aui-lozenge-current conf-macro output-inline" data-hasbody="false" data-macro-id="9b7635d3-7de5-4c02-8b71-751ce3f4a1d9" data-macro-name="status">OPTIONAL</span></p><ul><li><p><code>resourceTags</code> : 태그 항목에서는 리소스 태그의 키와 값으로 필터링할 수 있습니다. </p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="9b9de014-2f9d-43e5-b3e3-4e46c2d19fdf" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">resourceTags: 
  &quot;region&quot;: &quot;ap-northeast-1&quot;
  &quot;Owner&quot;: &quot;Brant&quot;</pre>
</div></div></li><li><p><code>userAttributes</code> : 사용자의 속성(attribute)을 조건으로 지정하고 값이 매칭되는 사용자에 한해서만 해당 정책에서 정의된 권한의 사용을 제한합니다. </p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="bd92697f-d6eb-4c40-99aa-b9c6bad7973d" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">userAttributes: 
  &quot;countryCode&quot;: &quot;KR&quot;
  &quot;department&quot;: &quot;Infra&quot;</pre>
</div></div></li><li><p><code>ipAddresses</code> : 리소스에 대한 IP 접근 통제 조건 리스트를 단일IP, CIDR 형태으로 정의합니다. </p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="f47b9722-b2b5-4d60-931d-dd5abf4ee359" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">ipAddresses: [&quot;10.10.0.0/24&quot;, &quot;10.11.10.1&quot;]</pre>
</div></div></li></ul><p /><h2 id="id-쿠버네티스정책YAMLCode문법안내-KACPolicy예시">KAC Policy 예시</h2><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-id="c993ff80-b384-4cb8-ae37-12a0744b1b2f" data-macro-name="code" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">apiVersion: kubernetes.rbac.querypie.com/v1 
kind: KacPolicy

spec:
  allow: 
    resources: 
      - &quot;cluster:*&quot;
    subjects: 
      kubernetesGroups: 
        - &quot;system:masters&quot;
      impersonation: 
        users: [&quot;system:serviceaccount:argocd&quot;] 
        groups: [&quot;system:admin&quot;]  
    actions: 
      - apiGroups: [&quot;*&quot;] 
        resources: 
          - &quot;pods&quot;
        namespace: &quot;*&quot; 
        name: &quot;*&quot; 
        verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]
    conditions: 
      resourceTags: 
        &quot;Owner&quot;: [&quot;Kenny&quot;, &quot;Brant&quot;]
        &quot;Team&quot;: &quot;DevSecOps&quot; 
      userAttributes: 
        &quot;countryCode&quot;: &quot;KR&quot;
        &quot;department&quot;: &quot;Infra&quot;
      ipAddresses: [&quot;10.10.0.0/24&quot;, &quot;10.11.10.1&quot;] 
  deny: 
    resources: 
      - &quot;cluster:kubepie-*&quot;
    actions: 
      - apiGroups: [&quot;*&quot;]
        resources: 
          - &quot;*&quot;
        namespace: &quot;production&quot;
        name: &quot;*&quot;
        verbs: [&quot;*&quot;]
    conditions: 
      resourceTags: 
        &quot;Owner&quot;: &quot;Brant&quot;</pre>
</div></div>