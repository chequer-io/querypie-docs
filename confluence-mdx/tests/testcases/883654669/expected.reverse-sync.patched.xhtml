<h2>Overview</h2><p>Slack App을 QueryPie에 연동하고, QueryPie로부터 Direct Message 알림을 받기할 수 있습니다.</p><ac:structured-macro ac:macro-id="44cc9f0c-9c85-4681-b6ed-75010e6450ce" ac:name="info" ac:schema-version="1"><ac:rich-text-body><p>본 문서는 <strong>10.2.6 또는 그 이상의 버전</strong>에 적용됩니다.</p><p>10.2.5 또는 그 이하 버전의 Slack 연동 방법은 <a href="https://docs.querypie.com/ko/querypie-manual/10.1.0/workflow-configurations">10.1.0 버전 매뉴얼 문서</a>를 참고해주세요.</p></ac:rich-text-body></ac:structured-macro><ac:structured-macro ac:local-id="c3d00c63-12a9-4498-b3e2-1f6e7e91066f" ac:macro-id="20a50dd1-17d2-461f-b2d3-cf8e141d0c23" ac:name="toc" ac:schema-version="1" data-layout="default"><ac:parameter ac:name="minLevel">1</ac:parameter><ac:parameter ac:name="maxLevel">2</ac:parameter><ac:parameter ac:name="outline">false</ac:parameter><ac:parameter ac:name="style">disc</ac:parameter><ac:parameter ac:name="exclude">Overview</ac:parameter><ac:parameter ac:name="type">list</ac:parameter><ac:parameter ac:name="printable">true</ac:parameter></ac:structured-macro><h3>구성 시 사전에 필요한 권한</h3><ul><li><p>Slack Workspace 관리자 권한 계정 (Slack Workspace에 App을 설치하기 위해 필요)</p></li><li><p>QueryPie Owner 및 Approval Admin 권한 계정</p></li></ul><h2>Slack API 에서 DM App 생성 (via Manifest Files)</h2><p>App Manifest를 이용하여 QueryPie DM 연동 전용 Slack App을 생성합니다.</p><p></p><ol start="1"><li><p><a href="https://api.slack.com/apps">https://api.slack.com/apps</a> 으로 이동하여 <code>Create an App</code> 을 클릭합니다.<br/></p><ac:image ac:align="center" ac:custom-width="true" ac:layout="center" ac:original-height="1203" ac:original-width="2317" ac:width="760"><ri:attachment ri:filename="image-20231227-065658.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p></li><li><p>Create an app 모달에서, App 생성 방식을 선택합니다. <code>From a manifest</code> 를 클릭합니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 1.17.25.png" ac:custom-width="true" ac:layout="center" ac:original-height="507" ac:original-width="712" ac:width="712"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 1.17.25.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p></li><li><p>Pick a workspace 모달에서 QueryPie와 연동할 Slack Workspace를 선택한 뒤 다음 단계로 진행합니다.<br/></p><ac:image ac:align="center" ac:custom-width="true" ac:layout="center" ac:original-height="443" ac:original-width="707" ac:width="710"><ri:attachment ri:filename="image-20231227-065951.png" ri:version-at-save="1"></ri:attachment></ac:image><p></p></li><li><p>Create app from manifest 모달에서 JSON 형식의 App Manifest를 입력합니다. <br/>미리 채워져 있는 내용들을 삭제하고 아래의 App Manifest를 붙여넣은 뒤 다음 단계로 진행합니다.<br/><ac:emoticon ac:emoji-fallback=":light_bulb_on:" ac:emoji-id="atlassian-light_bulb_on" ac:emoji-shortname=":light_bulb_on:" ac:name="light-on"></ac:emoticon><span style="background-color: rgb(254,222,200);"> </span><code>{{..}}</code><span style="background-color: rgb(254,222,200);">  안의 값은 원하는 값으로 변경해 주세요.</span></p><ac:structured-macro ac:macro-id="7431661e-8f16-40dd-8edf-84e7b117492f" ac:name="code" ac:schema-version="1"><ac:plain-text-body><![CDATA[{
    "display_information": {
        "name": "{{name}}"
    },
    "features": {
        "bot_user": {
            "display_name": "{{display_name}}",
            "always_online": false
        }
    },
    "oauth_config": {
        "scopes": {
            "bot": [
                "chat:write",
                "users:read.email",
                "users:read"
            ]
        }
    },
    "settings": {
        "interactivity": {
            "is_enabled": true
        },
        "org_deploy_enabled": false,
        "socket_mode_enabled": true,
        "token_rotation_enabled": false
    }
}]]></ac:plain-text-body></ac:structured-macro><p></p></li><li><p>설정 내용을 검토하고 <code>Create</code> 버튼을 클릭하여 App 생성을 완료합니다.<br/></p><ac:image ac:align="center" ac:alt="image-20240115-220447.png" ac:custom-width="true" ac:layout="center" ac:original-height="375" ac:original-width="574" ac:width="763"><ri:attachment ri:filename="image-20240115-220447.png" ri:version-at-save="1"></ri:attachment></ac:image><p></p></li></ol><h2>Slack Workspace에 Slack App 설치</h2><ol start="1"><li><p>Settings &gt; Install App에서 <code>Install to Workspace</code> 버튼을 클릭하여 생성된 앱을 Slack Workspace에 설치합니다. </p></li><li><p>권한 요청 페이지에서, <code>허용</code>을 클릭합니다.</p><ac:image ac:align="center" ac:alt="image-20240115-221520.png" ac:custom-width="true" ac:layout="center" ac:original-height="1203" ac:original-width="1720" ac:width="760"><ri:attachment ri:filename="image-20240115-221520.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p></li><li><p>설정한 Slack Workspace에서 Slack DM 전용 App이 생성된 것을 확인할 수 있습니다.</p><ac:image ac:align="center" ac:alt="image-20240115-221618.png" ac:custom-width="true" ac:layout="center" ac:original-height="991" ac:original-width="1624" ac:width="760"><ri:attachment ri:filename="image-20240115-221618.png" ri:version-at-save="1"></ri:attachment></ac:image></li></ol><h2>Bot User OAuth Token 획득</h2><p>Features &gt; OAuth &amp; Permissions 메뉴 내 OAuth Tokens for Your Workspace 섹션에서, <strong>Bot User OAuth Token</strong> 을 복사하여 기록해 둡니다.</p><ac:image ac:align="center" ac:alt="image-20240418-022640.png" ac:custom-width="true" ac:layout="wide" ac:original-height="1526" ac:original-width="3024" ac:width="764"><ri:attachment ri:filename="image-20240418-022640.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p><h2>App-Level Token 생성</h2><ac:structured-macro ac:macro-id="63581712-0376-4c4c-96cb-846de5153704" ac:name="info" ac:schema-version="1"><ac:rich-text-body><p>App manifest로 Slack app을 생성할 때 Socket Mode와 관련 권한들을 활성화할 수는 있지만, App Level Token(xapp-)은 자동으로 생성되지 않습니다.</p><ul><li><p>App Level Token은 보안 자격 증명(security credential)이기 때문에 manifest로 자동 생성/노출되면 보안상 위험</p></li><li><p>App manifest는 앱의 구성(configuration)만 정의하고, 실제 인증 토큰들은 별도로 생성/관리됨</p></li></ul></ac:rich-text-body></ac:structured-macro><p>다음 단계를 수행하여 App-Level Token을 수동으로 생성합니다.</p><ol start="1"><li><p>앱 설정 페이지의 Settings &gt; Basic Information 메뉴의 App-Level Tokens 섹션으로 이동하고, <code>Generate Token and Scope</code> 버튼을 클릭합니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 2.09.51.png" ac:custom-width="true" ac:layout="center" ac:original-height="794" ac:original-width="1169" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 2.09.51.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p></li><li><p>Generate an app-level token 모달에서, Add Scope 버튼을 클릭한 뒤 <code>connections:write</code> 를 추가합니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 2.15.55.png" ac:custom-width="true" ac:layout="center" ac:original-height="756" ac:original-width="804" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 2.15.55.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p></li><li><p>생성된 App-Level Token 모달에서, 앱 토큰을 복사하여 따로 기록해 둡니다. App-Level Token은 <code>xapp-</code> 으로 시작합니다.</p></li></ol><h2>QueryPie에서 Slack DM 설정하기</h2><ol start="1"><li><p>Admin &gt; General &gt; System &gt; Integrations &gt; Slack 메뉴로 진입한 뒤, <code>Configure</code> 버튼을 클릭하여 설정 모달을 엽니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-03-10 오전 11.35.09.png" ac:custom-width="true" ac:layout="center" ac:original-height="822" ac:original-width="1272" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-03-10 오전 11.35.09.png" ri:version-at-save="1"></ri:attachment><ac:caption><p>Administrator &gt; General &gt; System &gt; Integrations &gt; Slack &gt; Create a New Slack Configuration</p></ac:caption><ac:adf-mark color="#091e4224" key="border" size="1"></ac:adf-mark></ac:image><p></p></li><li><p>설정 모달에 아까 기록해둔 App Token과 Bot User OAuth Token을 입력합니다.</p></li><li><p>추가 설정 값은 다음과 같습니다. DM으로 Workflow 알림을 받고 메시지 안에서 승인/거절을 수행하려면 모든 설정 토글을 활성화 합니다.</p><ul><li><p><strong>Send Workflow Notification via Slack DM</strong> : 워크플로우 요청에 대한 Slack DM 전송 활성화</p></li><li><p><strong>Allow Users to approve or reject on Slack DM</strong> : Slack DM 내에서 승인 또는 거절 기능 활성화<br/></p><ac:image ac:align="center" ac:custom-width="true" ac:layout="center" ac:original-height="300" ac:original-width="480" ac:width="760"><ri:attachment ri:filename="image-20231003-054240.png" ri:version-at-save="1"></ri:attachment><ac:caption><p>액션 허용타입 예시 (좌) / 액션 비허용 타입 예시 (우)</p></ac:caption><ac:adf-mark color="#091e4224" key="border" size="1"></ac:adf-mark></ac:image><p></p></li></ul></li><li><p><code>Save</code> 버튼을 누르고 설정을 완료합니다.</p></li></ol><h2>Slack DM 설정 관리하기</h2><ol start="1"><li><p>Slack Configuration을 등록한 뒤, 현재 설정 상태를 화면에서 확인할 수 있습니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-03-10 오전 11.39.50.png" ac:custom-width="true" ac:layout="center" ac:original-height="822" ac:original-width="1272" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-03-10 오전 11.39.50.png" ri:version-at-save="1"></ri:attachment><ac:caption><p>Administrator &gt; General &gt; System &gt; Integrations &gt; Slack</p></ac:caption><ac:adf-mark color="#091e4224" key="border" size="1"></ac:adf-mark></ac:image><p></p></li><li><p><code>Edit</code> 버튼을 클릭하여 입력한 설정을 변경할 수 있습니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 3.28.40.png" ac:custom-width="true" ac:layout="center" ac:original-height="817" ac:original-width="1260" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 3.28.40.png" ri:version-at-save="1"></ri:attachment><ac:caption><p>Administrator &gt; General &gt; System &gt; Integrations &gt; Slack &gt; Edit the Slack Configuration</p></ac:caption><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image></li></ol><p></p><h2>Workflow 요청 시 Slack DM 테스트</h2><p>DB Access Request를 예시로, Slack DM 기능이 정상적으로 작동하는지 테스트를 수행합니다.</p><ol start="1"><li><p>QueryPie User &gt; Workflow 페이지에서 Submit Request 버튼을 클릭한 뒤, DB Access Request를 선택하여 요청 작성 화면으로 진입합니다. 요청 작성 화면에서 필요한 정보를 입력하고, 요청을 상신합니다.</p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 3.15.04.png" ac:custom-width="true" ac:layout="center" ac:original-height="817" ac:original-width="1260" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 3.15.04.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image><p></p></li><li><p>승인자는 앞에서 추가한 Slack App과의 DM으로 승인해야 할 요청 알림을 수신할 수 있습니다.<br/><strong>Allow Users to approve or reject on Slack DM</strong> 설정이 켜져 있으므로, DM에서 직접 사유를 입력하고 요청을 승인 또는 거절할 수 있습니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 3.22.38.png" ac:custom-width="true" ac:layout="center" ac:original-height="354" ac:original-width="701" ac:width="701"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 3.22.38.png" ri:version-at-save="1"></ri:attachment></ac:image><p></p></li><li><p>DM에서 <code>Details</code> 버튼을 클릭 시, QueryPie Admin에서 결재 요청에 대한 상세 내용을 확인하고 승인 또는 거절할 수 있습니다.<br/></p><ac:image ac:align="center" ac:alt="스크린샷 2025-02-18 오후 3.25.27.png" ac:custom-width="true" ac:layout="center" ac:original-height="817" ac:original-width="1260" ac:width="736"><ri:attachment ri:filename="스크린샷 2025-02-18 오후 3.25.27.png" ri:version-at-save="1"></ri:attachment><ac:adf-mark color="#091e4224" key="border" size="2"></ac:adf-mark></ac:image></li></ol>